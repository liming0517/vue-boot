webpackJsonp([20],{803:function(e,t,a){function i(e){a(937)}var l=a(17)(a(881),a(966),i,null,null);e.exports=l.exports},823:function(e,t,a){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"记录",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"永久删除";return new n.a(function(i,l){s.MessageBox.confirm("此操作将"+t+e+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i()}).catch(function(){a.i(s.Message)({type:"info",message:"已取消此操作"})})})}t.a=i;var l=a(82),n=a.n(l),s=a(111);a.n(s)},881:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(823);a(300);t.default={data:function(){return{formTitle:"新建",createForm:!1,tableColumShow:!1,tableQuery:{limit:10,currentPage:1,sft_TemplateType:null,sft_State:null},tableCreate:{sft_Code:null,sft_TemplateType:null,sft_State:null},stateArr:[{value:"0",label:"禁用"},{value:"1",label:"启用"}],querySubmiting:!1,queryForm:!1,total:0,tableData:[],tableLoading:!1,stateChange:{sft_Code:null,sft_State:null},getFfile:{sf_BussinessCode:null},fileList:[],limitNum:20,formLabelWidth:"80px",form:{file:""},fileID:"",pdfUrl:"",otherData:{fileID:null},isPreview:!1,uploadPath:this.HOST_PROXY_ADMIN+"/file/file/upload",fileArr:[],deleteData:{sf_Code:null}}},methods:{openCreateDialog:function(e){if("edit"==e){if(null==this.tableCreate.sft_Code)return void this.$notify({title:"提示",message:"请选择一条数据！",type:"warning",duration:2e3});this.getFileArr(),this.createForm=!0}else this.clearCreateDialog(),this.createForm=!0},getFileArr:function(){var e=this;this.getFfile.sf_BussinessCode=this.tableCreate.sft_Code,this.$api.file.template.filelist1({data:this.getFfile}).then(function(t){e.fileList=t.data.data.Filelist,e.getFileList()}).catch(function(e){console.log(e)})},clearCreateDialog:function(){this.tableCreate.sft_Code=null,this.tableCreate.sft_TemplateType=null,this.tableCreate.sft_State=null},changeState:function(e){var t=this;"0"==e.sft_State?e.sft_State="1":"1"==e.sft_State&&(e.sft_State="0"),this.$api.file.template.save({data:e}).then(function(e){"Succees"==e.data.data.Succeed?t.$notify({title:"提示",message:"修改成功！",type:"success",duration:2e3}):t.$notify({title:"提示",message:"修改失败！",type:"error",duration:2e3})}).catch(function(e){t.$notify({title:"提示",message:"修改失败！",type:"error",duration:2e3}),console.log(e)})},saveCreate:function(){var e=this;this.$api.file.template.save({data:this.tableCreate}).then(function(t){"Succees"==t.data.data.Succeed?(e.createForm=!1,e.$notify({title:"提示",message:"保存成功！",type:"success",duration:2e3}),e.getApplyList()):e.$notify({title:"提示",message:"保存失败！",type:"error",duration:2e3})}).catch(function(t){e.$notify({title:"提示",message:"保存失败！",type:"error",duration:2e3}),console.log(t)})},getApplyList:function(){var e=this;this.tableLoading=!0,this.$api.file.template.list({data:this.tableQuery}).then(function(t){e.total=t.data.data.total,e.tableData=t.data.data.list,e.queryForm=!1,e.tableLoading=!1,e.clearCreateDialog()}).catch(function(t){e.tableLoading=!1,console.log(t)})},rowClick:function(e){this.tableCreate.sft_Code=e.sft_Code,this.tableCreate.sft_TemplateType=e.sft_TemplateType,this.tableCreate.sft_State=e.sft_State},handleCurrentChange:function(e){this.tableQuery.currentPage=e,this.getApplyList()},handleSizeChange:function(e){this.tableQuery.limit=e,this.getApplyList()},exceedFile:function(e,t){this.$notify.warning({title:"警告",message:"只能选择 "+this.limitNum+" 个文件，当前共选择了 "+(e.length+t.length)+" 个"})},fileChange:function(e,t){this.form.file=e.raw},beforeUploadFile:function(e){var t=e.name,a=t.substring(t.lastIndexOf("."),t.length);if(".doc"!=a&&".pdf"!=a&&".docx"!=a&&".xls"!=a&&".xlsx"!=a)return e.create="true",!1;this.otherData.fileID=this.tableCreate.sft_Code,this.$parent.$parent.$parent.hideOrShow()},handleSuccess:function(e,t,a){this.$notify.success({title:"成功",message:"文件上传成功"}),this.getFileArr(),this.$parent.$parent.$parent.hideOrShow()},handleError:function(e,t,a){this.$notify.error({title:"错误",message:"文件上传失败"})},uploadFile:function(){this.$refs.uploadExcel.submit()},download:function(){if(null==this.fileID||""==this.fileID)return void this.$notify({title:"提示",message:"请选择一个文件！",type:"warning",duration:2e3});var e=new Blob([],{type:"application/excel;charset=utf-8"}),t=document.createElement("a");window.URL.createObjectURL(e);t.href=this.HOST_PROXY_ADMIN+"/file/file/download?id="+this.fileID,document.body.appendChild(t),t.click(),document.body.removeChild(t)},getFileList:function(){var e=this;this.fileArr=[],setTimeout(function(){for(var t=0;t<e.fileList.length;t++){var a={id:"",name:""};a.id=e.fileList[t].sf_Code,a.name=e.fileList[t].sf_FileName,e.fileArr.push(a)}},1e3)},previewFile:function(e){this.fileID=e.id},closePreview:function(){this.fileID=null,this.isPreview=!1,this.createForm=!1},previewPdf:function(){if(null==this.fileID||""==this.fileID)return void this.$notify({title:"提示",message:"请选择一个文件！",type:"warning",duration:2e3});this.isPreview=!0;var e=this.HOST_PROXY_ADMIN+"/file/file/preview?fileID="+this.fileID;this.pdfUrl=this.FONT_PROXY_PATH+"/static/pdf/web/viewer.html?url_file="+e},removeFile:function(e,t){var a=this;this.deleteData.sf_Code=e.id,this.$api.file.file.delete({data:this.deleteData}).then(function(e){"Succees"==e.data.data.Succeed?a.$notify({title:"成功",message:"删除成功",type:"success",duration:1500}):a.$notify({title:"失败",message:"删除失败",duration:1500})}).catch(function(e){a.$notify({title:"错误",message:e,type:"error",duration:3e3}),console.log(e)})},removeAlert:function(e,t){return void 0!=e.raw&&void 0!=e.raw.create?(this.$notify({title:"上传失败",message:"不支持该文件格式！",type:"error",duration:3e3}),this.fileArr=t.filter(function(t,a){return t.uid!=e.uid}),!1):a.i(i.a)(e.name).then(function(){})}},filters:{stateMap:function(e){return{0:"禁用",1:"启用"}[e]}},mounted:function(){this.getApplyList()}}},920:function(e,t,a){t=e.exports=a(787)(!0),t.push([e.i,"","",{version:3,sources:[],names:[],mappings:"",file:"template.vue",sourceRoot:""}])},937:function(e,t,a){var i=a(920);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(788)("87192520",i,!0)},966:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-container"},[a("div",{staticClass:"components-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{attrs:{type:"gray"},on:{click:e.getApplyList}},[a("i",{staticClass:"el-icon-refresh"}),e._v("刷新")]),e._v(" "),a("el-button",{attrs:{type:"gray"},on:{click:function(t){return e.openCreateDialog("create")}}},[a("i",{staticClass:"el-icon-plus"}),e._v("新建")]),e._v(" "),a("el-button",{attrs:{type:"gray"},on:{click:function(t){return e.openCreateDialog("edit")}}},[a("i",{staticClass:"el-icon-edit"}),e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"gray"},on:{click:function(t){e.queryForm=!0}}},[a("i",{staticClass:"el-icon-search"}),e._v("查询")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.tableLoading,expression:"tableLoading",modifiers:{body:!0}}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"element-loading-text":"拼命加载中",stripe:"",border:"",fit:"","highlight-current-row":""},on:{"row-click":e.rowClick}},[e.tableColumShow?a("el-table-column",{attrs:{label:"模板编号",prop:"sft_Code",align:"center",sortable:""}}):e._e(),e._v(" "),a("el-table-column",{attrs:{label:"申请类型",prop:"sft_TemplateType",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"sft_State",align:"center",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("stateMap")(t.row.sft_State)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return["0"==t.row.sft_State?a("el-button",{attrs:{size:"small",type:"success"},on:{click:function(a){return e.changeState(t.row)}}},[a("i",{staticClass:"el-icon-circle-check"},[e._v("启用")])]):e._e(),e._v(" "),"1"==t.row.sft_State?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.changeState(t.row)}}},[a("i",{staticClass:"el-icon-circle-close"},[e._v("禁用")])]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.tableQuery.currentPage,"page-sizes":[10,20,50],"page-size":e.tableQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.tableQuery,"currentPage",t)},"update:current-page":function(t){return e.$set(e.tableQuery,"currentPage",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:"查询",visible:e.queryForm},on:{"update:visible":function(t){e.queryForm=t}}},[a("el-form",{staticClass:"small-space",staticStyle:{width:"100%","margin-left":"0px"},attrs:{model:e.tableQuery,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"申请类型"}},[a("el-input",{attrs:{name:"sft_TemplateType",autoComplete:"on",maxlength:"50"},model:{value:e.tableQuery.sft_TemplateType,callback:function(t){e.$set(e.tableQuery,"sft_TemplateType",t)},expression:"tableQuery.sft_TemplateType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tableQuery.sft_State,callback:function(t){e.$set(e.tableQuery,"sft_State",t)},expression:"tableQuery.sft_State"}},e._l(e.stateArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.queryForm=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"warning",loading:e.querySubmiting},on:{click:e.getApplyList}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.formTitle,visible:e.createForm,"before-close":e.closePreview},on:{"update:visible":function(t){e.createForm=t}}},[a("el-form",{staticClass:"small-space",staticStyle:{width:"100%","margin-left":"0px"},attrs:{model:e.tableCreate,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"申请类型",required:!0}},[a("el-input",{attrs:{name:"sft_TemplateType",autoComplete:"on",maxlength:"50"},model:{value:e.tableCreate.sft_TemplateType,callback:function(t){e.$set(e.tableCreate,"sft_TemplateType",t)},expression:"tableCreate.sft_TemplateType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.tableCreate.sft_State,callback:function(t){e.$set(e.tableCreate,"sft_State",t)},expression:"tableCreate.sft_State"}},e._l(e.stateArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),null!=e.tableCreate.sft_Code&&"1"==e.tableCreate.sft_State?a("div",[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"上传文件","label-width":e.formLabelWidth}},[a("el-upload",{ref:"uploadExcel",attrs:{action:e.uploadPath,limit:e.limitNum,"auto-upload":!0,"before-upload":e.beforeUploadFile,"on-change":e.fileChange,"on-exceed":e.exceedFile,"on-success":e.handleSuccess,"on-error":e.handleError,"on-preview":e.previewFile,"on-remove":e.removeFile,"before-remove":e.removeAlert,data:e.otherData,"with-credentials":!0,accept:".doc,.docx,.xls,.xlsx,.pdf","file-list":e.fileArr}},[a("el-button",{attrs:{size:"small",type:"success"}},[e._v("选择文件")]),e._v(" "),a("span",{staticStyle:{color:"red"}},[e._v(" *只能上传格式为doc、docx、xls、xlsx、pdf 的文件")])],1)],1),e._v(" "),a("span",[e._v("       ")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.download()}}},[e._v("下载")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(t){return e.previewPdf()}}},[e._v("预览")])],1),e._v(" "),e.isPreview?a("div",[a("iframe",{attrs:{id:"previewPdf",src:e.pdfUrl,height:"560",width:"100%"}})]):e._e()],1):a("div",[a("el-form-item",{attrs:{label:"上传文件"}},[a("el-button",{attrs:{size:"small",type:"success",disabled:""}},[e._v("选择文件")]),a("span",{staticStyle:{color:"red"}},[e._v(" * 保存或启用后才能上传文件")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createForm=!1,e.isPreview=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"warning",loading:e.querySubmiting},on:{click:e.saveCreate}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]}}});
//# sourceMappingURL=20.99d770cdb0296f458fe6.js.map